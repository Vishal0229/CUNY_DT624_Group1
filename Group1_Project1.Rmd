---
title: "CUNY DT 624"
subtitle: "Project 1"
author: "Group 1: Avraham Adler, Vishal Arora, Samuel Bellows, Austin Chan"
date: "Summer 2020"
output:
  word_document:
    toc: true
    toc_depth: 3
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(readxl)
library(fpp2)
library(data.table)
```

# Introduction
The purpose of this report is to describe the analysis performed in order to
forecast the following series, each for 140 periods.

 * S01: Forecast Var01 and Var02
 * S02: Forecast Var02 and Var03
 * S03: Forecast Var05 and Var07
 * S04: Forecast Var01 and Var02
 * S05: Forecast Var02 and Var03
 * S06: Forecast Var05 and Var07
 
The forecasts will be provided in a separate Excel document. The code for the
analysis can be found in the attached R markdown document.

# Executive Summary

# Analysis
## Data Preprocessing
The data was converted to CSV, read into R, and then split into seperate files
by group.
```{r datapreprocess, include=FALSE}
# Read in Data
DT <- read_xls('./project1data/Data Set for class.xls')
# Set as data table
setDT(DT)
# Seperate out groups
n <- length(unique(DT$group))
for (i in seq_len(n)) {
  gName <- paste0('S0', i)
  assign(gName, DT[group == gName])
}
```

## Data Investigation
Each of the separate series was investigated for correlation, autocorrelation,
and stationarity. For each data series, the last 140 periods are those needing
the forecast. The first 1622 periods are the data.

### Missing Data
There are missing data elements in the series. Excluding the last 140 entries,
the respective series are missing the following data elements:
```{r missingData, echo=FALSE}
DT[, lapply(.SD, function(x) sum(is.na(x)) - 140),
   .SDcols = c(3:7), keyby = group]
# Following is useful to quickly remove "future" periods from groups
futureobs <- 1623:1762
```

These will be addressed in the individual series discussions. The sections will
address the key findings. Detailed technical analysis for those interested may
be found in the appendix.

### Series 01
#### Observations
Variables 01 and 02 (V1 & V2 from now on) of Series 01 (S1 from now on) can each
be considered a time series. Plotted on the same scale, it is clear that V1 is
increasing and V2 is decreasing.
```{r scaleV, echo=FALSE, fig.width=8L, fig.height=6L}
V1 <- scale(S01$Var01[-futureobs])
V2 <- scale(S01$Var02[-futureobs])
plot(V2, type = 'l', col = 'green4', main = "Series 01 Variables",
     xlab = "Time", ylab = "Scaled Values", ylim = c(-2, 8))
lines(V1, col = 'blue')
legend('topright', legend = c('V1', 'V2'), col = c('blue', 'green4'), lty = 1L)
```

What is of immediate interest is that while the values of the unscaled V1 are
many orders of magnitude greater than those of V2, on a scaled bases its
variance is significantly less.

One also sees that clearly V1 and V2 are negatively correlated with each other,
as V1 has an increasing secular trend whereas V2 has an overall decreasing one.

Initially, both multiplicative and additive time series were investigated.


# Technical Appendix
The `R` language was used for this analysis. The reader of the appendix is
assumed to have some basic statistical and programming experience.
## Series 01
### Classical Decomposition
#### Additive


